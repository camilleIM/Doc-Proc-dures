<!-- Pour re-g√©n√©rer search-index.json, lancer dans la console: node generate-index.js -->

<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Compagnie Maritime ‚Äî Documentation</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="app">
      <nav>
        <div id="sidebar-container"></div>
      </nav>
      <main class="main.home">
        <div class="topbar">
          <div class="breadcrumbs">Accueil / Documentation</div>
          <div class="actions">
            <!-- <button class="btn">Cr√©er note</button> -->
            <!-- <button class="btn">Exporter PDF</button> -->
            <button id="exportPdfBtn">üìÑ Exporter en PDF</button>
          </div>
        </div>
        <div class="hero">
          <div class="card hero-left">
            <h3>Bienvenue dans la documentation</h3>
            <p class="meta">
              Retrouvez ici les proc√©dures, fiches de poste, plans des quais, et
              toute information utile pour le fonctionnement de la compagnie
              maritime.
            </p>
          </div>
          <div class="card">
            <h3>Raccourcis</h3>
            <ul class="list">
              <li><strong>Num√©ros importants</strong> ‚Äî Acc√®s rapide</li>
              <li><strong>Fiches de poste</strong> ‚Äî Mise √† jour annuelle</li>
              <li><strong>Quais</strong> ‚Äî Plans & restrictions</li>
            </ul>
          </div>
        </div>
        <section class="grid">
          <div class="card">
            <div class="section-title">Histoire & infos g√©n√©rales</div>
            <p class="meta">
              R√©sum√© historique, dates cl√©s, valeurs et structure de
              l'entreprise.
            </p>
          </div>
          <div class="card">
            <div class="section-title">Services & op√©rations</div>
            <ul class="list">
              <li>Navettes & dessertes</li>
              <li>Privatisation & √©v√©nements</li>
              <li>Plong√©e & croisi√©ristes</li>
            </ul>
          </div>
          <div class="card">
            <div class="section-title">S√©curit√© & proc√©dures</div>
            <ul class="list">
              <li>Proc√©dures s√©curit√© passagers</li>
              <li>Secourisme & formation</li>
              <li>Proc√©dures par service</li>
            </ul>
          </div>
          <div class="card">
            <div class="section-title">Zones & cartes</div>
            <ul class="list">
              <li>Cartes de navigation</li>
              <li>Zones de restriction & points sensibles</li>
              <li>Ports et quais</li>
            </ul>
          </div>
        </section>
        <footer>¬© Groupe Lamanage ‚Äî Documentation interne</footer>
      </main>
    </div>

    <script>
      // Charger la sidebar depuis un fichier externe
      fetch("sidebar.html")
        .then((response) => response.text())
        .then((data) => {
          document.getElementById("sidebar-container").innerHTML = data;

          // Initialiser les menus d√©roulants APR√àS le chargement de la sidebar
          const collapsers = document.querySelectorAll(".collapser");
          collapsers.forEach((btn) => {
            btn.addEventListener("click", () => {
              const target = document.getElementById(btn.dataset.target);
              const chev = btn.querySelector(".chev");

              document.querySelectorAll(".submenu").forEach((menu) => {
                if (menu !== target) {
                  menu.classList.remove("open");
                  menu.hidden = true;
                  const otherChev = menu.parentElement.querySelector(".chev");
                  if (otherChev) otherChev.classList.remove("open");
                }
              });

              target.hidden = !target.hidden;
              chev.classList.toggle("open");
              target.classList.toggle("open");
            });
          });
        })
        .catch((err) =>
          console.error("Erreur lors du chargement de la sidebar :", err)
        );
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <script>
      document
        .getElementById("exportPdfBtn")
        .addEventListener("click", function () {
          const element =
            document.querySelector("main") ||
            document.getElementById("content");

          const options = {
            margin: 0.5,
            filename: document.title.replace(/\s+/g, "_") + ".pdf",
            image: { type: "jpeg", quality: 0.98 },
            html2canvas: { scale: 2 },
            jsPDF: { unit: "in", format: "a4", orientation: "portrait" },
          };

          html2pdf().set(options).from(element).save();
        });
    </script>
    <script>
      const collapsers = document.querySelectorAll(".collapser");
      collapsers.forEach((btn) => {
        btn.addEventListener("click", () => {
          const target = document.getElementById(btn.dataset.target);
          const chev = btn.querySelector(".chev");

          document.querySelectorAll(".submenu").forEach((menu) => {
            if (menu !== target) {
              menu.classList.remove("open");
              menu.hidden = true;
              const otherChev = menu.parentElement.querySelector(".chev");
              if (otherChev) otherChev.classList.remove("open");
            }
          });

          target.hidden = !target.hidden;
          chev.classList.toggle("open");
          target.classList.toggle("open");
        });
      });
    </script>
  </body>
</html>
